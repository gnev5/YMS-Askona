# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üöÄ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **TimeSlot —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –¥–∞—Ç–∞–º** –≤–º–µ—Å—Ç–æ day_of_week
2. **–£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π** - –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å = –æ–¥–Ω–∞ –ø–µ—Ä–µ–≤–æ–∑–∫–∞
3. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º** –º–µ–∂–¥—É –∑–∞–ø–∏—Å—è–º–∏ –∏ —Å–ª–æ—Ç–∞–º–∏
4. **–î–æ–±–∞–≤–ª–µ–Ω –∂—É—Ä–Ω–∞–ª —Å–ª–æ—Ç–æ–≤** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ç–æ—á–µ—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ –Ω–∞ 4 –Ω–µ–¥–µ–ª–∏ –≤–ø–µ—Ä–µ–¥** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ‚úÖ –ñ—É—Ä–Ω–∞–ª —Å–ª–æ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ –¢–æ—á–µ—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—Ç–∞–º–∏ (–≤–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤—è–∑–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏
python rebuild_database.py
```

### ??? 4: ???????? Volume Quotas + booking_type
```bash
python -m app.migrate_volume_quotas
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î
```bash
# –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose down

# –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d

# –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î
docker compose exec backend python -m app.migrate_existing_db

# –®–∞–≥ 4: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
docker compose exec backend python -m app.seed
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†—É—á–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
```bash
# –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose down

# –®–∞–≥ 2: –£–¥–∞–ª–∏—Ç—å —Ç–æ–º —Å –¥–∞–Ω–Ω—ã–º–∏
docker volume rm yms-askona_db_data

# –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d

# –®–∞–≥ 4: –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
docker compose exec backend python -m app.migrate_database

# –®–∞–≥ 5: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
docker compose exec backend python -m app.seed
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã time_slots
docker compose exec db psql -U yms -d yms -c "\d time_slots"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
docker compose exec db psql -U yms -d yms -c "SELECT COUNT(*) FROM time_slots;"
docker compose exec db psql -U yms -d yms -c "SELECT COUNT(*) FROM bookings;"
docker compose exec db psql -U yms -d yms -c "SELECT COUNT(*) FROM booking_time_slots;"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª–µ slot_date —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
docker compose exec db psql -U yms -d yms -c "SELECT slot_date, start_time, end_time FROM time_slots LIMIT 5;"
```

## üîß –ù–æ–≤—ã–µ API endpoints:

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—Ç–∞–º–∏:
- `GET /api/time-slots/journal` - –∂—É—Ä–Ω–∞–ª —Å–ª–æ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `POST /api/time-slots/generate` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ –Ω–∞ –ø–µ—Ä–∏–æ–¥
- `PUT /api/time-slots/{id}/availability` - –≤–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å —Å–ª–æ—Ç
- `DELETE /api/time-slots/{id}` - —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ª–æ—Ç

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏:
- `POST /api/bookings` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ–µ)
- `GET /api/bookings/{id}/slots` - –ø–æ–ª—É—á–∏—Ç—å —Å–ª–æ—Ç—ã –∑–∞–ø–∏—Å–∏
- `PUT /api/bookings/{id}/cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å
- `DELETE /api/bookings/{id}` - —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ TimeSlot –∏–∑–º–µ–Ω–∏–ª–∞—Å—å:**
   - –£–±—Ä–∞–Ω–æ –ø–æ–ª–µ `day_of_week`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `slot_date` (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–∞—Ç–∞)
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `is_available`, `created_at`, `updated_at`

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Booking –∏–∑–º–µ–Ω–∏–ª–∞—Å—å:**
   - –£–±—Ä–∞–Ω—ã –ø–æ–ª—è `time_slot_id`, `booking_date`, `group_id`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `status`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `created_at`, `updated_at`

3. **–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ BookingTimeSlot:**
   - –°–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É Booking –∏ TimeSlot
   - –ü–æ–ª—è: `booking_id`, `time_slot_id`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ª–æ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ñ—É—Ä–Ω–∞–ª —Å–ª–æ—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
5. –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîÑ –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫):

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose down

# –£–¥–∞–ª–∏—Ç—å —Ç–æ–º —Å –¥–∞–Ω–Ω—ã–º–∏
docker volume rm yms-askona_db_data

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker compose up --build -d

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏
docker compose exec backend python -m app.seed
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î
- ‚úÖ –ó–∞–ø–∏—Å–∏ –±–æ–ª—å—à–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∂—É—Ä–Ω–∞–ª —Å–ª–æ—Ç–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é
